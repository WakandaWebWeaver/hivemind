<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ user.full_name }} on HiveMind</title>
    <link href="/static/bootstrap.css" rel="stylesheet">
    <link href="/static/bootstrap.min.css" rel="stylesheet">

    <script src="https://kit.fontawesome.com/5849743ccd.js" crossorigin="anonymous"></script>
    <link rel="icon" href="/static/imgs/favicon.ico" type="image/x-icon">
    <script type="module" src="https://cdn.jsdelivr.net/npm/ldrs/dist/auto/dotStream.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/ldrs/dist/auto/leapfrog.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/ldrs/dist/auto/waveform.js"></script>

    <link rel="stylesheet" href="/static/styles.css">

    <style>
        .checkbox-wrapper-35 .switch {
            display: none;
        }

        .checkbox-wrapper-35 .switch+label {
            -webkit-box-align: center;
            -webkit-align-items: center;
            -ms-flex-align: center;
            align-items: center;
            color: #78768d;
            cursor: pointer;
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            font-size: 12px;
            line-height: 15px;
            position: relative;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .checkbox-wrapper-35 .switch+label::before,
        .checkbox-wrapper-35 .switch+label::after {
            content: '';
            display: block;
        }

        .checkbox-wrapper-35 .switch+label::before {
            background-color: #05012c;
            border-radius: 500px;
            height: 15px;
            margin-right: 8px;
            -webkit-transition: background-color 0.125s ease-out;
            transition: background-color 0.125s ease-out;
            width: 25px;
        }

        .checkbox-wrapper-35 .switch+label::after {
            background-color: #fff;
            border-radius: 13px;
            box-shadow: 0 3px 1px 0 rgba(37, 34, 71, 0.05), 0 2px 2px 0 rgba(37, 34, 71, 0.1), 0 3px 3px 0 rgba(37, 34, 71, 0.05);
            height: 13px;
            left: 1px;
            position: absolute;
            top: 1px;
            -webkit-transition: -webkit-transform 0.125s ease-out;
            transition: -webkit-transform 0.125s ease-out;
            transition: transform 0.125s ease-out;
            transition: transform 0.125s ease-out, -webkit-transform 0.125s ease-out;
            width: 13px;
        }

        .checkbox-wrapper-35 .switch+label .switch-x-text {
            display: block;
            margin-right: .3em;
        }

        .checkbox-wrapper-35 .switch+label .switch-x-toggletext {
            display: block;
            font-weight: bold;
            height: 15px;
            overflow: hidden;
            position: relative;
            width: 25px;
        }

        .checkbox-wrapper-35 .switch+label .switch-x-unchecked,
        .checkbox-wrapper-35 .switch+label .switch-x-checked {
            left: 0;
            position: absolute;
            top: 0;
            -webkit-transition: opacity 0.125s ease-out, -webkit-transform 0.125s ease-out;
            transition: opacity 0.125s ease-out, -webkit-transform 0.125s ease-out;
            transition: transform 0.125s ease-out, opacity 0.125s ease-out;
            transition: transform 0.125s ease-out, opacity 0.125s ease-out, -webkit-transform 0.125s ease-out;
        }

        .checkbox-wrapper-35 .switch+label .switch-x-unchecked {
            opacity: 1;
            -webkit-transform: none;
            transform: none;
        }

        .checkbox-wrapper-35 .switch+label .switch-x-checked {
            opacity: 0;
            -webkit-transform: translate3d(0, 100%, 0);
            transform: translate3d(0, 100%, 0);
        }

        .checkbox-wrapper-35 .switch+label .switch-x-hiddenlabel {
            position: absolute;
            visibility: hidden;
        }

        .checkbox-wrapper-35 .switch:checked+label::before {
            background-color: #ffb500;
        }

        .checkbox-wrapper-35 .switch:checked+label::after {
            -webkit-transform: translate3d(10px, 0, 0);
            transform: translate3d(10px, 0, 0);
        }

        .checkbox-wrapper-35 .switch:checked+label .switch-x-unchecked {
            opacity: 0;
            -webkit-transform: translate3d(0, -100%, 0);
            transform: translate3d(0, -100%, 0);
        }

        .checkbox-wrapper-35 .switch:checked+label .switch-x-checked {
            opacity: 1;
            -webkit-transform: none;
            transform: none;
        }
    </style>

</head>

<body>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('index') }}">HiveMind</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto">
                    {% if current_user.is_authenticated %}
                    <li class="nav-item">
                        <div class="profile-picture-div-navbar"> <img src="{{ profile_picture_url }}"
                                alt="Profile Picture" class="nav-profile-picture rounded-circle"
                                style="width: 40px; height: 40px;">
                        </div>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('index') }}">Home</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Hives
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="{{ url_for('hives') }}">View Hives</a>
                        </div>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('logout') }}">Logout</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('materials') }}">Study Materials</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('view_posts') }}">View Posts</a>
                    </li>
                    {% if user.username == current_user.id %}
                    <div class="dropdown notifications">
                        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Notifications
                        </button>
                        <div class="dropdown-menu notifications" aria-labelledby="dropdownMenuButton">
                            {% for notification in user.notifications %}
                            <div class="alert {% if notification.unread %} alert-danger {% endif %}" role="alert"
                                id="notifications-div-{{ notification.id }}">
                                {{ notification.message }}
                                <button class="btn btn-primary"
                                    onclick="notifAction('{{ notification.id }}', 'mark_read')"><i
                                        class="fa-regular fa-bell"></i></button>
                                <button class="btn btn-primary"
                                    onclick="notifAction('{{ notification.id }}', 'delete')"><i
                                        class="fas fa-trash"></i></button>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                    {% else %}
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('login') }}">Login</a>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="input-group" style="padding: 10px;">
            <input type="text" class="form-control" id="user-search-bar" name="search" placeholder="Search for users"
                aria-label="Search for users" aria-describedby="button-addon2">
            <div class="input-group-append">
                <button class="btn btn-outline-secondary" type="submit" id="button-addon2"><i
                        class="fas fa-search"></i></button>
            </div>
            <div class="container input-group-append" style="margin: 5px;">
                <div class="checkbox-wrapper-35">
                    <input value="private" name="switch" id="switch" type="checkbox" class="switch">
                    <label for="switch">
                        <span class="switch-x-text">Search only in my college </span>
                        <span class="switch-x-toggletext">
                            <span class="switch-x-unchecked"><span class="switch-x-hiddenlabel">Unchecked:
                                </span>Off</span>
                            <span class="switch-x-checked"><span class="switch-x-hiddenlabel">Checked: </span>On</span>
                        </span>
                    </label>
                </div>
            </div>
        </div>

        <div class="list-group bg-light" id="search-results" style="margin: 10px auto; width: 400px; z-index: 10;">
        </div>
    </div>

    <div class="container mt-5 main-container">
        <div class="row">
            {% if user %}
            <div>
                <div class="profile-picture-div mb-4" style="margin: auto;">
                    <img src="{{ builder_url }}{{ user.profile_picture_s3_key }}" alt="Profile Picture"
                        class="rounded-circle profile-picture">
                </div>
                {% if user.profile_song %}
                <div class="container">
                    <div class="music-loader" role="status">
                        <l-line-wobble size="80" stroke="5" bg-opacity="0.1" speed="1.75" color="white"
                            id="music-loader"></l-line-wobble>
                    </div>
                    <iframe style="border-radius:10px" src="{{ user.profile_song }}?utm_source=generator"
                        width="max-content" height="100" frameBorder="0" allowfullscreen=""
                        allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
                        loading="lazy" onload="handleMusicEmbedLoad(this)"></iframe>
                </div>
                {% endif %}
            </div>

            <div class="container col-md-4">
                {% if user.blacklist %}
                <h1 class="text-danger">User is blacklisted</h1>
                {% endif %}
                <h2>{{ user.username }} | {% if user.verified %}<i class="fas fa-circle-check check"></i>{% endif %}
                </h2>

                <h5 class="text-muted">{{ user.full_name }}</h5>
                <h5 class="text-muted">College: {{ user.college_name }}</h5>
                <h5 class="text-muted">Year: {{ user.year }}</h5>
                <hr>
                {% if not user.blacklist %}
                <div class="container row">
                    <div class="container col-md-6">
                        <a class="a-special-case-no-hover" href="#" data-toggle="modal" data-target="#followersModal">
                            <h4 id="follower-count">{{ follower_count }} Followers</h4>
                        </a>
                    </div>
                    <div class="container col-md-6">
                        <a class="a-special-case-no-hover" href="#" data-toggle="modal" data-target="#followingModal">
                            <h4 id="following-count">{{ following_count }} Following</h4>
                        </a>
                    </div>
                    <div class="container col-md-6">
                        <h4>{{ post_count }} Posts</h4>
                    </div>
                </div>
                <hr>
                <div class="container row" style="padding: 10px;">
                    {% if user.username == current_user.id %}
                    <a class="btn btn-primary" style="padding: 10px; margin: 5px;" data-toggle="modal"
                        data-target="#updateProfileModal"><i class="fas fa-user-cog"></i> Update
                        Profile</a>
                    <a class="btn btn-primary" style="padding: 10px; margin: 5px;" href="/Diary"><i
                            class="fas fa-pen"></i> make a note</a>
                    {% if user.profile_song %}
                    <a class="btn btn-primary" style="padding: 10px; margin: 5px;" href="#add-song" data-toggle="modal"
                        data-target="#songModal"><i class="fas fa-music"></i> Change Profile Song</a>
                    {% else %}
                    <a class="btn btn-primary" style="padding: 10px; margin: 5px;" href="#add-song" data-toggle="modal"
                        data-target="#songModal"><i class="fas fa-music"></i> Set Profile Song</a>
                    {% endif %}
                    {% endif %}

                    {% if user.username != current_user.id %}
                    {% if session.id not in user.followers %}
                    <button class="btn btn-primary" style="padding: 10px; margin: 5px;" onclick="reachAction('follow')"
                        id="follow-btn"><i class="fas fa-user-plus"></i>
                        Follow</button>
                    {% else %}
                    <button class="btn btn-primary" style="padding: 10px; margin: 5px;"
                        onclick="reachAction('unfollow')" id="unfollow-btn"><i class="fas fa-user-minus"></i>
                        Unfollow</button>
                    {% endif %}
                    {% endif %}
                </div>
            </div>

            <div class="container col-md-4">
                <h4>Bio</h4>
                <p>{{ user.bio }}</p>
                <hr>
            </div>
            {% endif %}
            {% else %}
            <p>User not found</p>
            {% endif %}
        </div>
    </div>

    <div class="modal fade center" id="followersModal" tabindex="-1" role="dialog" aria-labelledby="followersModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content text-light bg-dark">
                <div class="modal-header">
                    <h5 class="modal-title" id="followersModalLabel">Followers</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <ul class="list-group">
                        {% for follower in user.followers %}
                        <li class="list-group text-center">
                            <div class="container">
                                <div class="col-md-4">
                                    <a class="a-special-case-no-hover text-center" href="/view_profile/{{ follower }}">
                                        <h5 class="text-center">{{ follower }}</h5>
                                    </a>
                                </div>
                            </div>
                        </li>
                        <hr>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade center" id="followingModal" tabindex="-1" role="dialog" aria-labelledby="followingModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content text-light bg-dark">
                <div class="modal-header">
                    <h5 class="modal-title" id="followingModalLabel">Following</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <ul class="list-group">
                        {% for following in user.following %}
                        <li class="list-group text-light">
                            <div class="container row">
                                <div class="col-md-4">
                                    <a class="a-special-case-no-hover text-center" href="/view_profile/{{ following }}"
                                        style="margin: 10px auto;">
                                        <h5 class="text-center">{{ following }}</h5>
                                    </a>
                                </div>
                            </div>
                        </li>
                        <hr>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade" id="updateProfileModal" tabindex="-1" role="dialog"
        aria-labelledby="updateProfileModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content bg-dark">
                <div class="modal-header">
                    <h5 class="modal-title text-light" id="updateProfileModalLabel">Update Profile</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="container">
                        <form class="text-light" id="account-settings-form" action="/update_profile" method="POST"
                            enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="profile-pic">Profile Picture</label>
                                <input type="file" class="form-control-file" id="profile-pic" name="profile_picture"
                                    accept="image/*">
                            </div>
                            <div class="form-group">
                                <label for="bio">Bio</label>
                                <textarea class="form-control" id="bio" name="bio" rows="4"
                                    placeholder="put something fun"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="username">Username</label>
                                <input type="text" class="form-control" id="username" name="username"
                                    placeholder="not case sensitive">
                                <l-waveform size="35" stroke="3.5" speed="1" color="white" id="username-check-loader"
                                    style="display: none;"></l-waveform>
                                <div id="username-feedback"></div>
                            </div>
                            <div class="form-group">
                                <label for="FullName">Name</label>
                                <input type="text" class="form-control" id="name" name="name"
                                    placeholder="this may remove your verified status.">
                            </div>
                            <div class="form-group">
                                <select class="form-control" name="year">
                                    <option value="1">1st Year</option>
                                    <option value="2">2nd Year</option>
                                    <option value="3">3rd Year</option>
                                    <option value="4">4th Year</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn-primary">Save Changes</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="songModal" tabindex="-1" role="dialog" aria-labelledby="songModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-dark" id="songModalLabel">Select a Song to display on your
                        profile</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="select-song-form">
                        <div class="form-group">
                            <label for="songName" class=" text-dark">Song Name</label>
                            <input type="text" class="form-control" id="songName" placeholder="Enter song name">
                        </div>
                        <input type="hidden" name="artist_name" id="artist_name">
                        <input type="hidden" name="embed_url" id="embed_url">
                        <div id="songResults" class="list-group"></div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="addSong()">Save changes</button>
                    <l-leapfrog size='40' speed='2.5' color='black' id="add-song-btn-loader"
                        style="display: none;"></l-leapfrog>

                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js"
        integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+"
        crossorigin="anonymous"></script>

    <script>

        function notifAction(id, action) {
            fetch('/notif_action', {
                method: 'POST',
                body: JSON.stringify({
                    'notif_id': id,
                    'action': action
                }),
                headers: {
                    'Content-Type': 'application/json'
                }
            }).then(response => response.json())
                .then(data => {
                    if (data.success) {
                        if (action === 'mark_read') {
                            notifDiv.classList.remove('alert-danger');
                            notifDiv.classList.add('alert-secondary');
                        } else {
                            notifDiv.remove();
                        }
                    } else {
                        alert('Failed to perform action');
                    }
                });
        }

        function reachAction(action) {
            const followBtn = document.getElementById('follow-btn');
            const unfollowBtn = document.getElementById('unfollow-btn');
            var followCount = document.getElementById('follower-count');
            var followingCount = document.getElementById('following-count');

            if (action === 'follow') {
                fetch('/follow_user', {
                    method: 'POST',
                    body: JSON.stringify({
                        'username': '{{ user.username }}'
                    }),
                    headers: {
                        'Content-Type': 'application/json'
                    }
                }).then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            window.location.reload();
                        } else {
                            alert('Failed to follow user. ');
                        }
                    });
            } else {
                fetch('/unfollow_user', {
                    method: 'POST',
                    body: JSON.stringify({
                        'username': '{{ user.username }}'
                    }),
                    headers: {
                        'Content-Type': 'application/json'
                    }
                }).then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            window.location.reload();
                        } else {
                            alert('Failed to unfollow user. ');
                        }
                    });
            }
        }


        document.addEventListener('DOMContentLoaded', () => {
            const usernameInput = document.getElementById('username');
            const usernameFeedback = document.getElementById('username-feedback');
            const usernameCheckLoader = document.getElementById('username-check-loader');

            usernameInput.addEventListener('input', async () => {
                usernameCheckLoader.style.display = 'block';
                const username = usernameInput.value.trim();
                if (username.length > 0) {
                    if (!/^[a-zA-Z0-9_]+$/.test(username)) {
                        usernameCheckLoader.style.display = 'none';
                        usernameFeedback.innerHTML = 'Username should only consist of letters, numbers, and underscores';
                        usernameInput.classList.add('is-invalid');
                    } else {
                        usernameInput.classList.remove('is-invalid');
                        const response = await fetch('/check_item', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ 'check_item': username, 'item': 'username' })
                        });
                        const data = await response.json();
                        if (data.available) {
                            usernameFeedback.innerHTML = 'Username is available.';
                            usernameCheckLoader.style.display = 'none';
                            usernameInput.classList.add('is-valid');
                        } else {
                            usernameFeedback.innerHTML = 'Username is taken.';
                            usernameCheckLoader.style.display = 'none';
                            usernameInput.classList.add('is-invalid');
                        }
                    }
                } else {
                    usernameFeedback.innerHTML = '';
                    usernameInput.classList.remove('is-invalid');
                }
            });
        });

        document.getElementById('account-settings-form').addEventListener('submit', (event) => {
            const profilePic = document.getElementById('profile-pic').value;
            const bio = document.getElementById('bio').value;
            const username = document.getElementById('username').value;

            if (!profilePic && !bio && !username) {
                modal.clos
            }
        });

        $('#user-search-bar').on('input', function () {
            var search = $('#user-search-bar').val();
            const collegeSearch = $('#switch').is(':checked');
            const searchLoader = "<l-dot-stream size='60' speed='2.5' color='black'></l-dot-stream>"

            if (search.length > 0) {
                $('#search-results').empty();
                $('#search-results').append(searchLoader);
                fetch('/search_user/' + search + '_' + collegeSearch)
                    .then(response => response.json())
                    .then(data => {
                        $('#search-results').empty();
                        const users = data['users'];
                        const names = data['names'];
                        if (users.length === 0) {
                            $('#search-results').append('<a href="#" class="list-group-item list-group-item-action">No users found</a>');
                        } else {
                            users.forEach((user, index) => {
                                $('.main-container').hide();
                                $('#search-results').append(`<a href="/view_profile/${user}" class="list-group-item list-group-item-action">${user}<br><span class='text-muted'>${names[index]}</span></a>`);
                            });
                        }
                    });

            } else {
                $('#search-results').empty();
            }
        });

        function handleMusicEmbedLoad(embed) {
            var loader = embed.previousElementSibling;
            loader.style.display = 'none';
        }

        $(document).click(function (e) {
            if (!$(e.target).closest('#search-results').length) {
                $('#search-results').empty();
                $('.main-container').show();
            }
        });

        function addSong() {
            const embedUrl = $('#embed_url').val();

            const songLoader = document.getElementById('add-song-btn-loader');
            songLoader.style.display = 'block';

            const embedUrlParts = embedUrl.split('/');
            const embedUrlValue = embedUrlParts[embedUrlParts.length - 1];

            fetch('/add_song', {
                method: 'POST',
                body: JSON.stringify({
                    'embed_url': embedUrlValue
                }),
                headers: {
                    'Content-Type': 'application/json'
                }

            })
                .then(response => response.json())
                .then(data => {
                    songLoader.style.display = 'none';
                    if (data.success) {
                        $('#songModal').modal('hide');
                        window.location.reload();
                    } else {
                        alert('Failed to add song');
                    }
                });
        }

        $('#songName').on('input', function () {
            const songName = $('#songName').val();
            const songLoader = "<l-leapfrog size='40' speed='2.5' color='black'></l-leapfrog>";

            $('#songResults').empty();
            $('#songResults').append(songLoader);

            fetch('/search_song', {
                method: 'POST',
                body: JSON.stringify({
                    'search_query': songName
                }),
                headers: {
                    'Content-Type': 'application/json'
                }

            })
                .then(response => response.json())
                .then(data => {
                    $('#songResults').empty();
                    const songs = data['songs'];
                    songs.forEach(song => {
                        $('#songResults').append(`
                            <a href="#" class="list-group-item list-group-item-action" onclick="selectSong('${song.embed_url}', '${song.song_name}', '${song.artist_name}')">
                                <img src="${song.album_image}" alt="Album Image" class="album-image" style="width: 40px; height: 40px;">
                                ${song.song_name}
                                <span class='text-muted'> by </span>
                                ${song.artist_name}
                            </a>
                        `);
                    });
                });
        });

        function selectSong(embed_url, song_name, artist_name) {
            $('#songName').val(song_name + ' by ' + artist_name);
            $('#embed_url').val(embed_url);
            $('#songResults').empty();
        }
    </script>

</body>

</html>